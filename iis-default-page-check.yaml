id: iis-default-page-check

info:
  name: Default IIS Windows Welcome Page
  author: ProjectDiscoveryAI
  severity: info
  description: |
    Detects the default IIS (Internet Information Services) Windows welcome page, which often indicates that the server is running but the specific application or content has not been set up on the root directory. Checks for additional paths /haproxy and /netdata which might be accessible.

flow: http(1) && http(2) && http(3)

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "IIS Windows"
          - "Welcome to IIS"
      - type: status
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/haproxy"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "HAProxy"
          - "Statistics Report"
      - type: status
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/netdata"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Netdata"
          - "Monitoring"
      - type: status
        status:
          - 200